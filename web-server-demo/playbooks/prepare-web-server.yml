---
  - name: "Prepare web server"
    hosts: awx-client.localdomain
    remote_user: jdoe
    become: true

    vars:
      source_folder: ../templates
      dest_folder: /usr/share/nginx/html

    tasks:
      - name: "Install nginx"
        yum:
          name: nginx
          state: latest

      - name: "Start nginx"
        service:
          name: nginx
          state: started

      - name: "Generate html file"
        template:
          src: "{{ source_folder }}/sample-page.j2"
          dest: "{{ dest_folder }}/sample-page.html"
        notify:
          - Restart Nginx

    handlers:
      - name: "Restart Nginx"
        service:
          name: nginx
          state: restarted
